This is the final test version I submit for CadContest 2022 ProblemD.